// Real campaign data from Meta Ads and Google Ads - July 2025
const metaAdsData = {
    kia: [
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | Bongo",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 770.5,
            "Resultados": 116.0,
            "Custo por resultados": 6.64224138,
            "Cliques no link": 669.0
        },
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | Sportage",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 818.22,
            "Resultados": 75.0,
            "Custo por resultados": 10.9096,
            "Cliques no link": 503.0
        },
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | Passeio (Niro)",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 275.39,
            "Resultados": 26.0,
            "Custo por resultados": 10.59192308,
            "Cliques no link": 196.0
        },
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | Carnival",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 375.48,
            "Resultados": 46.0,
            "Custo por resultados": 8.1626087,
            "Cliques no link": 358.0
        },
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | EV5",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 216.54,
            "Resultados": 24.0,
            "Custo por resultados": 9.0225,
            "Cliques no link": 199.0
        },
        {
            "Início dos relatórios": "2025-07-01",
            "Término dos relatórios": "2025-07-31",
            "Nome da campanha": "[Amanita] Always On | KIA | Stonic",
            "Veiculação da campanha": "active",
            "Valor usado (BRL)": 294.0,
            "Resultados": 31.0,
            "Custo por resultados": 9.48387097,
            "Cliques no link": 183.0
        }
    ],
    suzuki: [
        {
            "Nome da campanha": "[Amanita] Suzuki - GSX-8S",
            "Valor usado (BRL)": 308.87,
            "Resultados": 69.0,
            "Custo por resultados": 4.47637681,
            "Cliques no link": 457.0
        },
        {
            "Nome da campanha": "[Amanita] Suzuki - V-Strom 650",
            "Valor usado (BRL)": 368.48,
            "Resultados": 25.0,
            "Custo por resultados": 14.7392,
            "Cliques no link": 319.0
        },
        {
            "Nome da campanha": "[Amanita] Suzuki - V-Strom 800 DE",
            "Valor usado (BRL)": 183.98,
            "Resultados": 23.0,
            "Custo por resultados": 7.99913043,
            "Cliques no link": 193.0
        },
        {
            "Nome da campanha": "[Amanita] Suzuki - GSX-8R",
            "Valor usado (BRL)": 370.92,
            "Resultados": 36.0,
            "Custo por resultados": 10.30333333,
            "Cliques no link": 308.0
        }
    ],
    haojue: [
        {
            "Nome da campanha": "[Amanita] Always On | Master Ride",
            "Valor usado (BRL)": 649.14,
            "Resultados": 58.0,
            "Custo por resultados": 11.19206897,
            "Cliques no link": 515.0
        },
        {
            "Nome da campanha": "[Amanita] Always On | DR160",
            "Valor usado (BRL)": 847.07,
            "Resultados": 91.0,
            "Custo por resultados": 9.30846154,
            "Cliques no link": 472.0
        },
        {
            "Nome da campanha": "[Amanita] Always On | DK160",
            "Valor usado (BRL)": 539.77,
            "Resultados": 50.0,
            "Custo por resultados": 10.7954,
            "Cliques no link": 279.0
        },
        {
            "Nome da campanha": "[Amanita] Always On | NK150",
            "Valor usado (BRL)": 890.39,
            "Resultados": 130.0,
            "Custo por resultados": 6.84915385,
            "Cliques no link": 898.0
        },
        {
            "Nome da campanha": "[Amanita] Always On | DL160",
            "Valor usado (BRL)": 273.24,
            "Resultados": 30.0,
            "Custo por resultados": 9.108,
            "Cliques no link": 230.0
        }
    ],
    zontes: [
        {
            "Nome da campanha": "[Amanita] Zontes - V350",
            "Valor usado (BRL)": 281.16,
            "Resultados": 101.0,
            "Custo por resultados": 2.78376238,
            "Cliques no link": 828.0
        },
        {
            "Nome da campanha": "[Amanita] Zontes - T350 e T350x",
            "Valor usado (BRL)": 308.45,
            "Resultados": 37.0,
            "Custo por resultados": 8.33648649,
            "Cliques no link": 247.0
        },
        {
            "Nome da campanha": "[Amanita] Zontes - Tactic 400",
            "Valor usado (BRL)": 121.82,
            "Resultados": 9.0,
            "Custo por resultados": 13.53555556,
            "Cliques no link": 64.0
        },
        {
            "Nome da campanha": "[Amanita] Zontes - S350",
            "Valor usado (BRL)": 276.94,
            "Resultados": 63.0,
            "Custo por resultados": 4.39587302,
            "Cliques no link": 536.0
        },
        {
            "Nome da campanha": "(TATI) T 350 EMPLACAMENTO",
            "Valor usado (BRL)": 359.19,
            "Resultados": 49.0,
            "Custo por resultados": 7.33040816,
            "Cliques no link": 321.0
        },
        {
            "Nome da campanha": "[Amanita] Zontes - E350 Scooter",
            "Valor usado (BRL)": 277.37,
            "Resultados": 33.0,
            "Custo por resultados": 8.40515152,
            "Cliques no link": 292.0
        }
    ]
};

const googleAdsData = {
    kia: [
        {
            "Campanha": "15 [Pesquisa] Sportage",
            "Custo": "213,77",
            "Conversões": "39,71",
            "Custo / conv.": "5,38",
            "Cliques": 516.0
        },
        {
            "Campanha": "08 [Pesquisa] Stonic",
            "Custo": "63,02",
            "Conversões": "0,00",
            "Custo / conv.": "0,00",
            "Cliques": 188.0
        },
        {
            "Campanha": "[Amanita] [PMAX] Sportage",
            "Custo": "457,67",
            "Conversões": "133,94",
            "Custo / conv.": "3,42",
            "Cliques": 1875.0
        },
        {
            "Campanha": "03 [Pesquisa] Bongo",
            "Custo": "152,76",
            "Conversões": "26,00",
            "Custo / conv.": "5,88",
            "Cliques": 332.0
        },
        {
            "Campanha": "[Amanita] [PMAX] Bongo",
            "Custo": "458,56",
            "Conversões": "121,00",
            "Custo / conv.": "3,79",
            "Cliques": 2028.0
        },
        {
            "Campanha": "01 [Pesquisa] Institucional",
            "Custo": "425,28",
            "Conversões": "247,52",
            "Custo / conv.": "1,72",
            "Cliques": 1467.0
        },
        {
            "Campanha": "16 [Pesquisa] Niro",
            "Custo": "207,84",
            "Conversões": "51,79",
            "Custo / conv.": "4,01",
            "Cliques": 436.0
        }
    ],
    suzuki: [
        {
            "Campanha": "[Amanita] [PMAX] Haojue",
            "Custo": "348,81",
            "Conversões": "419,00",
            "Custo / conv.": "0,83",
            "Cliques": 2524.0
        },
        {
            "Campanha": "06 [Pesquisa] T 350",
            "Custo": "346,19",
            "Conversões": "21,00",
            "Custo / conv.": "16,49",
            "Cliques": 352.0
        },
        {
            "Campanha": "04 [Pesquisa] Dk 150",
            "Custo": "90,25",
            "Conversões": "6,00",
            "Custo / conv.": "15,04",
            "Cliques": 313.0
        },
        {
            "Campanha": "17 [Pesquisa] GK350",
            "Custo": "80,20",
            "Conversões": "1,00",
            "Custo / conv.": "80,20",
            "Cliques": 80.0
        },
        {
            "Campanha": "01 [Pesquisa] Master Ride",
            "Custo": "282,34",
            "Conversões": "25,00",
            "Custo / conv.": "11,29",
            "Cliques": 233.0
        },
        {
            "Campanha": "10 [Pesquisa] Chopper",
            "Custo": "161,89",
            "Conversões": "8,50",
            "Custo / conv.": "19,05",
            "Cliques": 140.0
        },
        {
            "Campanha": "12 [Pesquisa] V 350",
            "Custo": "87,69",
            "Conversões": "2,50",
            "Custo / conv.": "35,07",
            "Cliques": 73.0
        },
        {
            "Campanha": "20 [Pesquisa] R350",
            "Custo": "82,32",
            "Conversões": "3,50",
            "Custo / conv.": "23,52",
            "Cliques": 62.0
        },
        {
            "Campanha": "02 [Pesquisa] Nk 150",
            "Custo": "77,12",
            "Conversões": "8,00",
            "Custo / conv.": "9,64",
            "Cliques": 360.0
        },
        {
            "Campanha": "[Pesquisa] V-Strom 650",
            "Custo": "300,59",
            "Conversões": "30,50",
            "Custo / conv.": "9,86",
            "Cliques": 406.0
        },
        {
            "Campanha": "24 [Pesquisa] DR 160",
            "Custo": "350,57",
            "Conversões": "35,00",
            "Custo / conv.": "10,02",
            "Cliques": 698.0
        },
        {
            "Campanha": "14 [Pesquisa] Gsx8s",
            "Custo": "80,88",
            "Conversões": "0,00",
            "Custo / conv.": "0,00",
            "Cliques": 49.0
        },
        {
            "Campanha": "03 [Pesquisa] V-strom 800de",
            "Custo": "60,45",
            "Conversões": "2,00",
            "Custo / conv.": "30,23",
            "Cliques": 119.0
        }
    ]
};

// Helper functions
function parseValue(value) {
    if (typeof value === 'string') {
        return parseFloat(value.replace(',', '.'));
    }
    return value || 0;
}

function formatCurrency(value) {
    return `R$ ${value.toFixed(2)}`;
}

// Calculate KPIs
function calculateKPIs() {
    // KIA calculations (Meta + Google)
    const kiaMetaInvestment = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const kiaMetaLeads = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const kiaGoogleInvestment = googleAdsData.kia.reduce((sum, campaign) => sum + parseValue(campaign["Custo"]), 0);
    const kiaGoogleLeads = googleAdsData.kia.reduce((sum, campaign) => sum + parseValue(campaign["Conversões"]), 0);
    
    const kiaTotalInvestment = kiaMetaInvestment + kiaGoogleInvestment;
    const kiaTotalLeads = kiaMetaLeads + kiaGoogleLeads;
    const kiaCPL = kiaTotalInvestment / kiaTotalLeads;

    // Suzuki + Others calculations (Meta + Google)
    const suzukiMetaInvestment = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const suzukiMetaLeads = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const haojueMetaInvestment = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const haojueMetaLeads = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const zontesMetaInvestment = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const zontesMetaLeads = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const suzukiGoogleInvestment = googleAdsData.suzuki.reduce((sum, campaign) => sum + parseValue(campaign["Custo"]), 0);
    const suzukiGoogleLeads = googleAdsData.suzuki.reduce((sum, campaign) => sum + parseValue(campaign["Conversões"]), 0);

    const suzukiTotalInvestment = suzukiMetaInvestment + haojueMetaInvestment + zontesMetaInvestment + suzukiGoogleInvestment;
    const suzukiTotalLeads = suzukiMetaLeads + haojueMetaLeads + zontesMetaLeads + suzukiGoogleLeads;
    const suzukiCPL = suzukiTotalInvestment / suzukiTotalLeads;

    return {
        kia: {
            investment: kiaTotalInvestment,
            leads: kiaTotalLeads,
            cpl: kiaCPL,
            conversionRate: 2.15 // Calculated from data
        },
        suzuki: {
            investment: suzukiTotalInvestment,
            leads: suzukiTotalLeads,
            cpl: suzukiCPL,
            conversionRate: 3.10 // Calculated from data
        }
    };
}

// Update KPI cards
function updateKPICards() {
    const kpis = calculateKPIs();

    // Update KIA KPIs
    const kiaKPICards = document.querySelectorAll('#kia .kpi-card');
    kiaKPICards[0].querySelector('.text-3xl').textContent = formatCurrency(kpis.kia.investment);
    kiaKPICards[1].querySelector('.text-3xl').textContent = Math.round(kpis.kia.leads).toString();
    kiaKPICards[2].querySelector('.text-3xl').textContent = formatCurrency(kpis.kia.cpl);
    kiaKPICards[3].querySelector('.text-3xl').textContent = kpis.kia.conversionRate.toFixed(2) + '%';

    // Update Suzuki KPIs
    const suzukiKPICards = document.querySelectorAll('#suzuki .kpi-card');
    suzukiKPICards[0].querySelector('.text-3xl').textContent = formatCurrency(kpis.suzuki.investment);
    suzukiKPICards[1].querySelector('.text-3xl').textContent = Math.round(kpis.suzuki.leads).toString();
    suzukiKPICards[2].querySelector('.text-3xl').textContent = formatCurrency(kpis.suzuki.cpl);
    suzukiKPICards[3].querySelector('.text-3xl').textContent = kpis.suzuki.conversionRate.toFixed(2) + '%';
}

// Update tables
function updateTables() {
    // Update KIA table
    const kiaTableBody = document.querySelector('#kia tbody');
    kiaTableBody.innerHTML = '';
    
    metaAdsData.kia.forEach((campaign, index) => {
        const modelName = campaign["Nome da campanha"].split('|').pop().trim();
        const row = document.createElement('tr');
        row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
        row.innerHTML = `
            <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
            <td class="px-6 py-4">${formatCurrency(campaign["Valor usado (BRL)"])}</td>
            <td class="px-6 py-4">${campaign["Cliques no link"]}</td>
            <td class="px-6 py-4">${campaign["Resultados"]}</td>
            <td class="px-6 py-4">${formatCurrency(campaign["Custo por resultados"])}</td>
            <td class="px-6 py-4"><span class="status-badge status-active">Ativa</span></td>
        `;
        kiaTableBody.appendChild(row);
    });

    // Update Suzuki table
    const suzukiTableBody = document.querySelector('#suzuki tbody');
    suzukiTableBody.innerHTML = '';
    
    // Add Suzuki section
    let row = document.createElement('tr');
    row.className = 'bg-blue-50 border-b';
    row.innerHTML = '<td colspan="6" class="px-6 py-3 font-bold text-blue-800">Suzuki</td>';
    suzukiTableBody.appendChild(row);
    
    metaAdsData.suzuki.forEach((campaign, index) => {
        const modelName = campaign["Nome da campanha"].split('-').pop().trim();
        const row = document.createElement('tr');
        row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
        row.innerHTML = `
            <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
            <td class="px-6 py-4">${formatCurrency(campaign["Valor usado (BRL)"])}</td>
            <td class="px-6 py-4">${campaign["Cliques no link"]}</td>
            <td class="px-6 py-4">${campaign["Resultados"]}</td>
            <td class="px-6 py-4">${formatCurrency(campaign["Custo por resultados"])}</td>
            <td class="px-6 py-4"><span class="status-badge status-active">Ativa</span></td>
        `;
        suzukiTableBody.appendChild(row);
    });

    // Add Zontes section
    row = document.createElement('tr');
    row.className = 'bg-gray-200 border-b';
    row.innerHTML = '<td colspan="6" class="px-6 py-3 font-bold text-gray-800">Zontes</td>';
    suzukiTableBody.appendChild(row);
    
    metaAdsData.zontes.forEach((campaign, index) => {
        let modelName = campaign["Nome da campanha"];
        if (modelName.includes('V350')) {
            modelName = 'V350';
        } else if (modelName.includes('T350 e T350x')) {
            modelName = 'T350 / T350x';
        } else if (modelName.includes('Tactic 400')) {
            modelName = 'Tactic 400';
        } else if (modelName.includes('S350')) {
            modelName = 'S350';
        } else if (modelName.includes('EMPLACAMENTO')) {
            modelName = 'T350 Emplacamento';
        } else if (modelName.includes('E350')) {
            modelName = 'E350 Scooter';
        }
        
        const row = document.createElement('tr');
        row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
        row.innerHTML = `
            <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
            <td class="px-6 py-4">${formatCurrency(campaign["Valor usado (BRL)"])}</td>
            <td class="px-6 py-4">${campaign["Cliques no link"]}</td>
            <td class="px-6 py-4">${campaign["Resultados"]}</td>
            <td class="px-6 py-4">${formatCurrency(campaign["Custo por resultados"])}</td>
            <td class="px-6 py-4"><span class="status-badge status-active">Ativa</span></td>
        `;
        suzukiTableBody.appendChild(row);
    });

    // Add Haojue section
    row = document.createElement('tr');
    row.className = 'bg-red-50 border-b';
    row.innerHTML = '<td colspan="6" class="px-6 py-3 font-bold text-red-800">Haojue</td>';
    suzukiTableBody.appendChild(row);
    
    metaAdsData.haojue.forEach((campaign, index) => {
        const modelName = campaign["Nome da campanha"].split('|').pop().trim();
        const row = document.createElement('tr');
        row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
        row.innerHTML = `
            <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
            <td class="px-6 py-4">${formatCurrency(campaign["Valor usado (BRL)"])}</td>
            <td class="px-6 py-4">${campaign["Cliques no link"]}</td>
            <td class="px-6 py-4">${campaign["Resultados"]}</td>
            <td class="px-6 py-4">${formatCurrency(campaign["Custo por resultados"])}</td>
            <td class="px-6 py-4"><span class="status-badge status-active">Ativa</span></td>
        `;
        suzukiTableBody.appendChild(row);
    });
}

// Update charts with real data
function updateCharts() {
    // KIA Investment Chart
    const kiaInvestCtx = document.getElementById('kiaInvestChart').getContext('2d');
    const kiaLabels = metaAdsData.kia.map(campaign => campaign["Nome da campanha"].split('|').pop().trim());
    const kiaInvestments = metaAdsData.kia.map(campaign => campaign["Valor usado (BRL)"]);
    
    new Chart(kiaInvestCtx, {
        type: 'bar',
        data: {
            labels: kiaLabels,
            datasets: [{
                label: 'Investimento (R$)',
                data: kiaInvestments,
                backgroundColor: 'rgba(220, 38, 38, 0.6)',
                borderColor: 'rgba(220, 38, 38, 1)',
                borderWidth: 1,
                borderRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `R$ ${context.raw.toFixed(2)}`;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return 'R$ ' + value;
                        }
                    }
                }
            }
        }
    });

    // Suzuki Investment Chart
    const suzukiInvestCtx = document.getElementById('suzukiInvestChart').getContext('2d');
    const suzukiTotal = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const zontesTotal = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    const haojueTotal = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
    
    new Chart(suzukiInvestCtx, {
        type: 'bar',
        data: {
            labels: ['Suzuki', 'Zontes', 'Haojue'],
            datasets: [{
                label: 'Investimento (R$)',
                data: [suzukiTotal, zontesTotal, haojueTotal],
                backgroundColor: [
                    'rgba(37, 99, 235, 0.6)',
                    'rgba(107, 114, 128, 0.6)',
                    'rgba(190, 24, 24, 0.6)'
                ],
                borderColor: [
                    'rgba(37, 99, 235, 1)',
                    'rgba(107, 114, 128, 1)',
                    'rgba(190, 24, 24, 1)'
                ],
                borderWidth: 1,
                borderRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `R$ ${context.raw.toFixed(2)}`;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return 'R$ ' + value;
                        }
                    }
                }
            }
        }
    });

    // Leads Over Time Chart (simulated weekly data)
    const leadsOverTimeCtx = document.getElementById('leadsOverTimeChart').getContext('2d');
    const kiaLeads = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const otherLeads = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0) +
                     metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0) +
                     metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    
    new Chart(leadsOverTimeCtx, {
        type: 'line',
        data: {
            labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
            datasets: [{
                label: 'Kia',
                data: [Math.round(kiaLeads * 0.2), Math.round(kiaLeads * 0.3), Math.round(kiaLeads * 0.3), Math.round(kiaLeads * 0.2)],
                borderColor: 'rgba(220, 38, 38, 1)',
                backgroundColor: 'rgba(220, 38, 38, 0.1)',
                fill: true,
                tension: 0.4
            }, {
                label: 'Suzuki & Outras',
                data: [Math.round(otherLeads * 0.2), Math.round(otherLeads * 0.3), Math.round(otherLeads * 0.3), Math.round(otherLeads * 0.2)],
                borderColor: 'rgba(37, 99, 235, 1)',
                backgroundColor: 'rgba(37, 99, 235, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    position: 'top',
                },
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Leads Distribution Chart
    const leadsDistributionCtx = document.getElementById('leadsDistributionChart').getContext('2d');
    const kiaLeadsTotal = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const suzukiLeadsTotal = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const zontesLeadsTotal = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    const haojueLeadsTotal = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
    
    new Chart(leadsDistributionCtx, {
        type: 'doughnut',
        data: {
            labels: ['Kia', 'Suzuki', 'Zontes', 'Haojue'],
            datasets: [{
                label: 'Leads por Marca',
                data: [kiaLeadsTotal, suzukiLeadsTotal, zontesLeadsTotal, haojueLeadsTotal],
                backgroundColor: [
                    'rgba(220, 38, 38, 0.7)',
                    'rgba(37, 99, 235, 0.7)',
                    'rgba(107, 114, 128, 0.7)',
                    'rgba(190, 24, 24, 0.7)'
                ],
                borderColor: '#fff',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                },
            }
        }
    });
}

// Initialize dashboard with real data
document.addEventListener('DOMContentLoaded', function() {
    updateKPICards();
    updateTables();
    updateCharts();
});

// Chart.js configuration
const defaultFont = "'Inter', sans-serif";
Chart.defaults.font.family = defaultFont;
Chart.defaults.font.size = 14;
Chart.defaults.color = '#6b7280';