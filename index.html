<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Performance - Sun Motors</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="./shared/css/layout.css">
    
    <style>
        .kpi-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .status-active {
            background-color: #d1fae5;
            color: #065f46;
        }
        .status-attention {
            background-color: #fef3c7;
            color: #92400e;
        }
        .status-paused {
            background-color: #fee2e2;
            color: #991b1b;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="text-gray-800">
    <div class="overlay" id="overlay"></div>
    
    <div class="sidemenu mobile-hidden" id="sidemenu">
        <div class="sidemenu-header">
            <div class="sidemenu-logo">
                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                </svg>
                <span class="sidemenu-text">Sun Motors</span>
            </div>
            
            <div class="sidemenu-controls">
                <button class="sidemenu-btn desktop-collapse-btn" id="collapseBtn" title="Recolher menu (Ctrl+B)">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"/>
                    </svg>
                </button>
                
                <button class="sidemenu-btn mobile-close-btn" id="closeMobileMenu" title="Fechar menu">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <nav class="sidemenu-nav">
            <a href="./" class="nav-item active" data-page="dashboard">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 000 2h14a2 2 0 000-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"/>
                </svg>
                <span class="sidemenu-text">Dashboard</span>
            </a>
            
            <a href="pages/orcamento/" class="nav-item" data-page="orcamento">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17h6m0 0v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span class="sidemenu-text">Orçamento</span>
            </a>
            
            <a href="pages/publico-alvo/" class="nav-item" data-page="publico-alvo">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17h6m0 0v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span class="sidemenu-text">Público-Alvo</span>
            </a>
            
            <a href="pages/otimizacoes/" class="nav-item" data-page="otimizacoes">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                </svg>
                <span class="sidemenu-text">Otimizações</span>
            </a>
            
            <a href="pages/relatorios/" class="nav-item" data-page="relatorios">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span class="sidemenu-text">Relatórios</span>
            </a>
        </nav>
    </div>

    <div class="main-content" id="mainContent">
        <header class="top-header">
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
                <span class="sr-only">Abrir menu</span>
            </button>
            
            <h1>Dashboard de Performance</h1>
            
            <div class="w-8"></div>
        </header>

        <div class="main-content-inner">
            <div class="content-container">
            <header class="text-center mb-10">
                <h1 class="text-4xl font-bold text-gray-900">Dashboard de Performance - Tráfego Pago</h1>
                <p class="text-lg text-gray-600 mt-2">Kia Sun Motors & Suzuki Sun Motors</p>
            </header>

            <main class="space-y-12">

                <section id="kia" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                    <div class="flex items-center mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-600 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 000-7 3 3 0 000 7zM12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <h2 class="text-3xl font-bold text-gray-900">Kia Sun Motors</h2>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="kpi-card bg-red-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-red-800">Investimento Total</h3>
                            <p class="text-3xl font-bold text-red-900 mt-2">R$ 0,00</p>
                        </div>
                        <div class="kpi-card bg-green-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-green-800">Leads Gerados</h3>
                            <p class="text-3xl font-bold text-green-900 mt-2">0</p>
                        </div>
                        <div class="kpi-card bg-yellow-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-yellow-800">Custo por Lead (CPL)</h3>
                            <p class="text-3xl font-bold text-yellow-900 mt-2">R$ 0,00</p>
                        </div>
                        <div class="kpi-card bg-blue-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-blue-800">Taxa de Conversão</h3>
                            <p class="text-3xl font-bold text-blue-900 mt-2">0.00%</p>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Performance por Modelo</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-600">
                            <thead class="text-xs text-gray-700 bg-gray-100">
                                <tr>
                                    <th scope="col" class="px-6 py-3 rounded-l-lg">Modelo</th>
                                    <th scope="col" class="px-6 py-3">Investimento</th>
                                    <th scope="col" class="px-6 py-3">Cliques</th>
                                    <th scope="col" class="px-6 py-3">Leads</th>
                                    <th scope="col" class="px-6 py-3">CPL</th>
                                    <th scope="col" class="px-6 py-3 rounded-r-lg">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                     <div class="mt-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Investimento por Modelo (Kia)</h3>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <canvas id="kiaInvestChart"></canvas>
                        </div>
                    </div>
                </section>

                <section id="suzuki" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                    <div class="flex items-center mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600 mr-3" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M5.5 16a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM12 8c0-2.691-1.46-5.083-3.687-6.364A1 1 0 007.007.25L5.682 2.094A1 1 0 006.9 3.65l.593-.435a5.525 5.525 0 014.005 4.313 1 1 0 001.99.143zM14.5 16a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM12 9a1 1 0 00-1 1v1a1 1 0 002 0v-1a1 1 0 00-1-1z" />
                        </svg>
                        <h2 class="text-3xl font-bold text-gray-900">Suzuki Sun Motors</h2>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="kpi-card bg-blue-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-blue-800">Investimento Total</h3>
                            <p class="text-3xl font-bold text-blue-900 mt-2">R$ 0,00</p>
                        </div>
                        <div class="kpi-card bg-green-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-green-800">Leads Gerados</h3>
                            <p class="text-3xl font-bold text-green-900 mt-2">0</p>
                        </div>
                        <div class="kpi-card bg-yellow-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-yellow-800">Custo por Lead (CPL)</h3>
                            <p class="text-3xl font-bold text-yellow-900 mt-2">R$ 0,00</p>
                        </div>
                        <div class="kpi-card bg-purple-50 p-5 rounded-xl">
                            <h3 class="font-semibold text-purple-800">Taxa de Conversão</h3>
                            <p class="text-3xl font-bold text-purple-900 mt-2">0.00%</p>
                        </div>
                    </div>

                     <h3 class="text-xl font-semibold text-gray-800 mb-4">Performance por Marca/Modelo</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-600">
                            <thead class="text-xs text-gray-700 bg-gray-100">
                                <tr>
                                    <th scope="col" class="px-6 py-3 rounded-l-lg">Marca / Modelo</th>
                                    <th scope="col" class="px-6 py-3">Investimento</th>
                                    <th scope="col" class="px-6 py-3">Cliques</th>
                                    <th scope="col" class="px-6 py-3">Leads</th>
                                    <th scope="col" class="px-6 py-3">CPL</th>
                                    <th scope="col" class="px-6 py-3 rounded-r-lg">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                     <div class="mt-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Investimento por Marca (Suzuki & Associadas)</h3>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <canvas id="suzukiInvestChart"></canvas>
                        </div>
                    </div>
                </section>
                
                 <section id="general-charts" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Visão Geral da Campanha</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Leads Gerados (Julho)</h3>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <canvas id="leadsOverTimeChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Distribuição de Leads por Marca</h3>
                            <div class="bg-gray-50 p-4 rounded-lg h-80 flex items-center justify-center">
                                <canvas id="leadsDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>


                <section id="recomendacoes" class="bg-gray-800 text-white p-6 sm:p-8 rounded-2xl shadow-lg">
                    <div class="flex items-center mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <h2 class="text-3xl font-bold">Recomendações e Observações</h2>
                    </div>
                    <ul class="space-y-4 list-disc list-inside text-gray-300">
                        <li><strong class="font-semibold text-white">Kia Carnival & EV6:</strong> O CPL está acima da média. Recomendo revisar a segmentação de público e os criativos para otimizar a performance. Podemos testar novos ângulos de comunicação focados em benefícios mais específicos.</li>
                        <li><strong class="font-semibold text-white">Kia Bongo:</strong> Excelente performance com o CPL mais baixo. Sugiro aumentar gradualmente o investimento para escalar a geração de leads qualificados neste segmento.</li>
                        <li><strong class="font-semibold text-white">Haojue DL 160:</strong> Campanha de lançamento pausada. Aguardando definição da data oficial para reativar com força total, focando em "novidade" e "design aventureiro".</li>
                        <li><strong class="font-semibold text-white">Zontes:</strong> A marca apresenta um bom volume de leads com CPL competitivo. Manter a estratégia atual e focar na qualidade dos criativos, destacando a tecnologia embarcada.</li>
                    </ul>
                </section>

            </main>

            <footer class="text-center mt-12 py-4 border-t border-gray-200">
                <p class="text-sm text-gray-500">Dashboard atualizado em tempo real. Porto Alegre, 2024.</p>
            </footer>

            </div>
        </div>
    </div>

    <script src="./shared/js/sidemenu.js"></script>
    
    <script src="./data.js"></script>

    <script>
        // Helper functions
        function parseValue(value) {
            if (typeof value === 'string') {
                return parseFloat(value.replace(',', '.'));
            }
            return value || 0;
        }

        function formatCurrency(value) {
            return `R$ ${value.toFixed(2)}`;
        }

        // Calculate KPIs
        function calculateKPIs() {
            // KIA calculations (Meta + Google)
            const kiaMetaInvestment = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const kiaMetaLeads = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const kiaGoogleInvestment = googleAdsData.kia.reduce((sum, campaign) => sum + parseValue(campaign["Custo"]), 0);
            const kiaGoogleLeads = googleAdsData.kia.reduce((sum, campaign) => sum + parseValue(campaign["Conversões"]), 0);
            
            const kiaTotalInvestment = kiaMetaInvestment + kiaGoogleInvestment;
            const kiaTotalLeads = kiaMetaLeads + kiaGoogleLeads;
            const kiaCPL = kiaTotalLeads > 0 ? kiaTotalInvestment / kiaTotalLeads : 0;

            // Suzuki + Others calculations (Meta + Google)
            const suzukiMetaInvestment = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const suzukiMetaLeads = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const haojueMetaInvestment = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const haojueMetaLeads = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const zontesMetaInvestment = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const zontesMetaLeads = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const suzukiGoogleInvestment = googleAdsData.suzuki.reduce((sum, campaign) => sum + parseValue(campaign["Custo"]), 0);
            const suzukiGoogleLeads = googleAdsData.suzuki.reduce((sum, campaign) => sum + parseValue(campaign["Conversões"]), 0);

            const suzukiTotalInvestment = suzukiMetaInvestment + haojueMetaInvestment + zontesMetaInvestment + suzukiGoogleInvestment;
            const suzukiTotalLeads = suzukiMetaLeads + haojueMetaLeads + zontesMetaLeads + suzukiGoogleLeads;
            const suzukiCPL = suzukiTotalLeads > 0 ? suzukiTotalInvestment / suzukiTotalLeads : 0;

            return {
                kia: {
                    investment: kiaTotalInvestment,
                    leads: kiaTotalLeads,
                    cpl: kiaCPL,
                    conversionRate: 2.15 // This should be calculated dynamically
                },
                suzuki: {
                    investment: suzukiTotalInvestment,
                    leads: suzukiTotalLeads,
                    cpl: suzukiCPL,
                    conversionRate: 3.10 // This should be calculated dynamically
                }
            };
        }

        // Update KPI cards
        function updateKPICards() {
            const kpis = calculateKPIs();

            // Update KIA KPIs
            const kiaKPICards = document.querySelectorAll('#kia .kpi-card');
            kiaKPICards[0].querySelector('.text-3xl').textContent = formatCurrency(kpis.kia.investment);
            kiaKPICards[1].querySelector('.text-3xl').textContent = Math.round(kpis.kia.leads).toString();
            kiaKPICards[2].querySelector('.text-3xl').textContent = formatCurrency(kpis.kia.cpl);
            kiaKPICards[3].querySelector('.text-3xl').textContent = kpis.kia.conversionRate.toFixed(2) + '%';

            // Update Suzuki KPIs
            const suzukiKPICards = document.querySelectorAll('#suzuki .kpi-card');
            suzukiKPICards[0].querySelector('.text-3xl').textContent = formatCurrency(kpis.suzuki.investment);
            suzukiKPICards[1].querySelector('.text-3xl').textContent = Math.round(kpis.suzuki.leads).toString();
            suzukiKPICards[2].querySelector('.text-3xl').textContent = formatCurrency(kpis.suzuki.cpl);
            suzukiKPICards[3].querySelector('.text-3xl').textContent = kpis.suzuki.conversionRate.toFixed(2) + '%';
        }

        // Update tables
        function updateTables() {
            // Update KIA table
            const kiaTableBody = document.querySelector('#kia tbody');
            kiaTableBody.innerHTML = ''; // Clear existing static rows
            
            // Combine and process Kia data for the table
            const allKiaCampaigns = [
                ...metaAdsData.kia.map(c => ({...c, platform: 'Meta'})),
                ...googleAdsData.kia.map(c => ({...c, platform: 'Google'}))
            ];
            
            allKiaCampaigns.forEach((campaign, index) => {
                let modelName, investment, clicks, leads, cpl, status;

                if(campaign.platform === 'Meta') {
                    modelName = campaign["Nome da campanha"].split('|').pop().trim();
                    investment = campaign["Valor usado (BRL)"];
                    clicks = campaign["Cliques no link"];
                    leads = campaign["Resultados"];
                    cpl = campaign["Custo por resultados"];
                    status = campaign["Veiculação da campanha"] === 'active' ? 'Ativa' : 'Pausada';
                } else { // Google
                    modelName = campaign["Campanha"].split(']').pop().trim();
                    investment = parseValue(campaign["Custo"]);
                    clicks = campaign["Cliques"];
                    leads = parseValue(campaign["Conversões"]);
                    cpl = parseValue(campaign["Custo / conv."]);
                    status = 'Ativa'; // Assuming Google campaigns are active
                }

                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
                row.innerHTML = `
                    <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
                    <td class="px-6 py-4">${formatCurrency(investment)}</td>
                    <td class="px-6 py-4">${clicks}</td>
                    <td class="px-6 py-4">${Math.round(leads)}</td>
                    <td class="px-6 py-4">${formatCurrency(cpl)}</td>
                    <td class="px-6 py-4"><span class="status-badge ${status === 'Ativa' ? 'status-active' : 'status-paused'}">${status}</span></td>
                `;
                kiaTableBody.appendChild(row);
            });


            // Update Suzuki table
            const suzukiTableBody = document.querySelector('#suzuki tbody');
            suzukiTableBody.innerHTML = ''; // Clear existing static rows
            
            // This logic needs to be more complex to handle sub-brands properly
            // For now, let's just list them
            const suzukiBrands = {
                'Suzuki': metaAdsData.suzuki,
                'Zontes': metaAdsData.zontes,
                'Haojue': metaAdsData.haojue,
                // Google Ads data needs to be split by brand here
            };

            for (const brand in suzukiBrands) {
                 let headerRow = document.createElement('tr');
                 // This needs better styling based on brand
                 headerRow.className = 'bg-gray-100 border-b';
                 headerRow.innerHTML = `<td colspan="6" class="px-6 py-3 font-bold text-gray-800">${brand}</td>`;
                 suzukiTableBody.appendChild(headerRow);

                 suzukiBrands[brand].forEach((campaign, index) => {
                    const modelName = campaign["Nome da campanha"].split(/\||-/).pop().trim();
                    const row = document.createElement('tr');
                    row.className = index % 2 === 0 ? 'bg-white border-b' : 'bg-gray-50 border-b';
                    row.innerHTML = `
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900">${modelName}</th>
                        <td class="px-6 py-4">${formatCurrency(campaign["Valor usado (BRL)"])}</td>
                        <td class="px-6 py-4">${campaign["Cliques no link"]}</td>
                        <td class="px-6 py-4">${campaign["Resultados"]}</td>
                        <td class="px-6 py-4">${formatCurrency(campaign["Custo por resultados"])}</td>
                        <td class="px-6 py-4"><span class="status-badge status-active">Ativa</span></td>
                    `;
                    suzukiTableBody.appendChild(row);
                 });
            }
        }

        // Update charts with real data
        function updateCharts() {
            // KIA Investment Chart
            const kiaInvestCtx = document.getElementById('kiaInvestChart').getContext('2d');
            const kiaLabels = metaAdsData.kia.map(campaign => campaign["Nome da campanha"].split('|').pop().trim());
            const kiaInvestments = metaAdsData.kia.map(campaign => campaign["Valor usado (BRL)"]);
            
            new Chart(kiaInvestCtx, {
                type: 'bar',
                data: {
                    labels: kiaLabels,
                    datasets: [{
                        label: 'Investimento (R$)',
                        data: kiaInvestments,
                        backgroundColor: 'rgba(220, 38, 38, 0.6)',
                        borderColor: 'rgba(220, 38, 38, 1)',
                        borderWidth: 1,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `R$ ${context.raw.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value;
                                }
                            }
                        }
                    }
                }
            });

            // Suzuki Investment Chart
            const suzukiInvestCtx = document.getElementById('suzukiInvestChart').getContext('2d');
            const suzukiTotal = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const zontesTotal = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            const haojueTotal = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Valor usado (BRL)"], 0);
            
            new Chart(suzukiInvestCtx, {
                type: 'bar',
                data: {
                    labels: ['Suzuki', 'Zontes', 'Haojue'],
                    datasets: [{
                        label: 'Investimento (R$)',
                        data: [suzukiTotal, zontesTotal, haojueTotal],
                        backgroundColor: [
                            'rgba(37, 99, 235, 0.6)',
                            'rgba(107, 114, 128, 0.6)',
                            'rgba(190, 24, 24, 0.6)'
                        ],
                        borderColor: [
                            'rgba(37, 99, 235, 1)',
                            'rgba(107, 114, 128, 1)',
                            'rgba(190, 24, 24, 1)'
                        ],
                        borderWidth: 1,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `R$ ${context.raw.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value;
                                }
                            }
                        }
                    }
                }
            });

            // Leads Over Time Chart (simulated weekly data)
            const leadsOverTimeCtx = document.getElementById('leadsOverTimeChart').getContext('2d');
            const kiaLeads = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const otherLeads = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0) +
                                 metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0) +
                                 metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            
            new Chart(leadsOverTimeCtx, {
                type: 'line',
                data: {
                    labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
                    datasets: [{
                        label: 'Kia',
                        data: [Math.round(kiaLeads * 0.2), Math.round(kiaLeads * 0.3), Math.round(kiaLeads * 0.3), Math.round(kiaLeads * 0.2)],
                        borderColor: 'rgba(220, 38, 38, 1)',
                        backgroundColor: 'rgba(220, 38, 38, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Suzuki & Outras',
                        data: [Math.round(otherLeads * 0.2), Math.round(otherLeads * 0.3), Math.round(otherLeads * 0.3), Math.round(otherLeads * 0.2)],
                        borderColor: 'rgba(37, 99, 235, 1)',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Leads Distribution Chart
            const leadsDistributionCtx = document.getElementById('leadsDistributionChart').getContext('2d');
            const kiaLeadsTotal = metaAdsData.kia.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const suzukiLeadsTotal = metaAdsData.suzuki.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const zontesLeadsTotal = metaAdsData.zontes.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            const haojueLeadsTotal = metaAdsData.haojue.reduce((sum, campaign) => sum + campaign["Resultados"], 0);
            
            new Chart(leadsDistributionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Kia', 'Suzuki', 'Zontes', 'Haojue'],
                    datasets: [{
                        label: 'Leads por Marca',
                        data: [kiaLeadsTotal, suzukiLeadsTotal, zontesLeadsTotal, haojueLeadsTotal],
                        backgroundColor: [
                            'rgba(220, 38, 38, 0.7)',
                            'rgba(37, 99, 235, 0.7)',
                            'rgba(107, 114, 128, 0.7)',
                            'rgba(190, 24, 24, 0.7)' // Note: This red is similar to Kia's red
                        ],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                        },
                    }
                }
            });
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Check if data objects exist
            if (typeof metaAdsData !== 'undefined' && typeof googleAdsData !== 'undefined') {
                updateKPICards();
                updateTables();
                updateCharts();
            } else {
                console.error("Data objects (metaAdsData or googleAdsData) not found. Make sure data.js is loaded correctly.");
            }
        });

        // Chart.js global configuration
        const defaultFont = "'Inter', sans-serif";
        Chart.defaults.font.family = defaultFont;
        Chart.defaults.font.size = 14;
        Chart.defaults.color = '#6b7280';
    </script>
</body>
</html>